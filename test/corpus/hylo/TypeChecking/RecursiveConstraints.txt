====================
RecursiveConstraints
====================

//- typeCheck expecting: failure

fun use<T>(_ x: T) {}

trait Z3 {
  type A where A : Z3, A.A.A == Self
}

fun f<T: Z3>(_ v: T) {
  use<T.A.A.A>(v)
}

trait S {
  type A
  type B
  type C: S where C.A == B, C.C == Self
}

fun g<T: S>(_ v: T.C.B) {
  use<T.A>(v)
}

//! @+1 diagnostic requirement system too complex to build
trait I {
  type A: I
  type B: I
  type C: I
  type D: I
  type E: I where
    A.C == C.A,
    A.D == D.A,
    B.C == C.B,
    B.D == D.B,
    C.E == E.C.A,
    D.E == E.D.B,
    C.C.A == C.C.A.E
}

---

(source_file
  (single_line_comment)
  (function_decl
    (function_head
      (function_name
        (identifier))
      (generic_clause
        (generic_type_parameter
          (identifier))))
    (function_signature
      (parameter_decl
        (identifier)
        (name_type_expr
          (selector
            (identifier_expr
              (identifier))))))
    (brace_stmt))
  (trait_decl
    (trait_head
      (identifier))
    (associated_type_decl
      (identifier)
      (where_clause
        (conformance_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier))))
          (trait_composition
            (name_type_expr
              (selector
                (identifier_expr
                  (identifier))))))
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier))))))))
  (function_decl
    (function_head
      (function_name
        (identifier))
      (generic_clause
        (generic_type_parameter
          (identifier)
          (trait_composition
            (name_type_expr
              (selector
                (identifier_expr
                  (identifier))))))))
    (function_signature
      (parameter_decl
        (identifier)
        (name_type_expr
          (selector
            (identifier_expr
              (identifier))))))
    (brace_stmt
      (stmt
        (function_call_expr
          (selector_expr
            (selector
              (identifier_expr
                (identifier))
              (static_argument_list
                (static_argument
                  (name_type_expr
                    (selector
                      (identifier_expr
                        (identifier)))
                    (selector
                      (identifier_expr
                        (identifier)))
                    (selector
                      (identifier_expr
                        (identifier)))
                    (selector
                      (identifier_expr
                        (identifier))))))))
          (call_argument
            (selector_expr
              (selector
                (identifier_expr
                  (identifier)))))))))
  (trait_decl
    (trait_head
      (identifier))
    (associated_type_decl
      (identifier))
    (associated_type_decl
      (identifier))
    (associated_type_decl
      (identifier)
      (conformance_list
        (name_type_expr
          (selector
            (identifier_expr
              (identifier)))))
      (where_clause
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))))
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier))))))))
  (function_decl
    (function_head
      (function_name
        (identifier))
      (generic_clause
        (generic_type_parameter
          (identifier)
          (trait_composition
            (name_type_expr
              (selector
                (identifier_expr
                  (identifier))))))))
    (function_signature
      (parameter_decl
        (identifier)
        (name_type_expr
          (selector
            (identifier_expr
              (identifier)))
          (selector
            (identifier_expr
              (identifier)))
          (selector
            (identifier_expr
              (identifier))))))
    (brace_stmt
      (stmt
        (function_call_expr
          (selector_expr
            (selector
              (identifier_expr
                (identifier))
              (static_argument_list
                (static_argument
                  (name_type_expr
                    (selector
                      (identifier_expr
                        (identifier)))
                    (selector
                      (identifier_expr
                        (identifier))))))))
          (call_argument
            (selector_expr
              (selector
                (identifier_expr
                  (identifier)))))))))
  (single_line_comment)
  (trait_decl
    (trait_head
      (identifier))
    (associated_type_decl
      (identifier)
      (conformance_list
        (name_type_expr
          (selector
            (identifier_expr
              (identifier))))))
    (associated_type_decl
      (identifier)
      (conformance_list
        (name_type_expr
          (selector
            (identifier_expr
              (identifier))))))
    (associated_type_decl
      (identifier)
      (conformance_list
        (name_type_expr
          (selector
            (identifier_expr
              (identifier))))))
    (associated_type_decl
      (identifier)
      (conformance_list
        (name_type_expr
          (selector
            (identifier_expr
              (identifier))))))
    (associated_type_decl
      (identifier)
      (conformance_list
        (name_type_expr
          (selector
            (identifier_expr
              (identifier)))))
      (where_clause
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))))
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))))
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))))
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))))
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))))
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))))
        (equality_constraint
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier))))
          (name_type_expr
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))
            (selector
              (identifier_expr
                (identifier)))))))))
